<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reset Your Password</title>
    <style>
        .bg-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            object-fit: cover;
            opacity: 0.3;
            z-index: -1;
            pointer-events: none; /* So it's not clickable */
        }
    </style>
</head>
<body style="font-family:sans-serif;text-align:center;padding:2rem; background-color:rgb(79, 79, 79);">
  <img src="https://geimon-app-833627ba44e0.herokuapp.com/Public/Images/Site Assets/try_2.png" class="bg-image" alt="">
  <h2>Choose a New Password</h2>
  <input type="password" id="newPassword" placeholder="New Password" required style="width:100%;max-width:300px;padding:8px;"><br><br>
  <input type="password" id="confirmPassword" placeholder="Confirm Password" required style="width:100%;max-width:300px;padding:8px;"><br><br>
  <button id="resetBtn">Reset Password</button>
  <div id="message" style="margin-top:1rem;color:green;"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const token  = params.get('token');
    const msgDiv = document.getElementById('message');

    document.getElementById('resetBtn').addEventListener('click', async () => {
      const pw  = document.getElementById('newPassword').value;
      const pw2 = document.getElementById('confirmPassword').value;
      if (!pw || !pw2) {
        msgDiv.style.color = 'red';
        return msgDiv.textContent = 'Fill in both fields.';
      }
      if (pw !== pw2) {
        msgDiv.style.color = 'red';
        return msgDiv.textContent = 'Passwords do not match.';
      }

      try {
        const res = await fetch('https://YOUR_API_DOMAIN/password-reset/confirm', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          credentials: 'include',
          body: JSON.stringify({ token, newPassword: pw })
        });
        const data = await res.json();
        if (res.ok) {
          msgDiv.style.color = 'green';
          msgDiv.textContent = 'Password reset! You can now log in.';
        } else {
          msgDiv.style.color = 'red';
          msgDiv.textContent = data.message || 'Error resetting password.';
        }
      } catch {
        msgDiv.style.color = 'red';
        msgDiv.textContent = 'Network error.';
      }
    });
  </script>
</body>
</html>
